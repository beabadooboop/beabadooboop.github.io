<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Autosport News</title>
    <style>
        body {
            background-color: #282c35; /* Dark background color */
            color: #fff; /* Light text color */
            font-family: 'Arial', sans-serif;
            margin-left: 20px; /* Add a left margin */
            margin-right: 20px; /* Add a right margin */
        }

        h1 {
            color: #61dafb; /* Header text color */
        }

        ul {
            list-style: none; /* Remove bullets */
            padding: 0;
        }

        li {
            margin-bottom: 20px; /* Add margin below each item */
            display: flex; /* Use flexbox for better layout control */
            align-items: flex-start;
        }

        img.thumbnail {
            max-width: 100px; /* Adjust the maximum width of the thumbnail as needed */
            margin-right: 10px; /* Add margin to the right of the thumbnail */
        }

        a {
            color: #61dafb; /* Link color */
            text-decoration: none; /* Remove underline from links */
        }

        span.date {
            color: grey; /* Grey text color for date and time */
            display: block; /* Display the date on a new line */
        }

        /* Other existing styles remain unchanged */
    </style>
</head>
<body>
    <h1>Autosport News</h1>
    <ul id="rssFeed"></ul>

    <script>
        document.addEventListener("DOMContentLoaded", async function () {
            const rssFeedElement = document.getElementById("rssFeed");

            const rssFeedUrl = "https://www.autosport.com/rss/all/news/";
            const titleKeywordRegex = /oscar|piastri/i;
            const linkKeywordRegex = /btcc|motogp|super-formula|supercars|wrc/i;

            try {
                const response = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(rssFeedUrl)}`);
                const data = await response.json();
                const items = data.items || [];

                const filteredItems = items
                    .filter(item => !titleKeywordRegex.test(item.title))
                    .filter(item => !linkKeywordRegex.test(item.link))
                    .sort((a, b) => new Date(b.pubDate) - new Date(a.pubDate));

                filteredItems.forEach(item => {
                    const title = item.title;
                    const link = item.link;
                    const pubDate = new Date(item.pubDate);
                    const today = new Date();
                    let formattedDate;

                    if (
                        pubDate.getFullYear() === today.getFullYear() &&
                        pubDate.getMonth() === today.getMonth() &&
                        pubDate.getDate() === today.getDate()
                    ) {
                        formattedDate = 'Today ' + pubDate.toLocaleTimeString(undefined, {
                            hour: 'numeric',
                            minute: 'numeric'
                        });
                    } else {
                        formattedDate = pubDate.toLocaleString(undefined, {
                            year: 'numeric',
                            month: 'long',
                            day: 'numeric',
                            hour: 'numeric',
                            minute: 'numeric'
                        });
                    }

                    const thumbnailUrl = item.enclosure ? item.enclosure.link : ''; // Use the enclosure link as the thumbnail URL

                    // Create HTML elements
                    const li = document.createElement("li");
                    const img = document.createElement("img");
                    img.src = thumbnailUrl;
                    img.alt = "Thumbnail"; // Add alt text for accessibility
                    img.classList.add('thumbnail'); // Add a class for styling

                    const infoDiv = document.createElement("div");
                    const a = document.createElement("a");
                    a.textContent = title;
                    a.href = link;
                    infoDiv.appendChild(a);

                    const dateSpan = document.createElement("span");
                    dateSpan.textContent = formattedDate;
                    dateSpan.classList.add('date');
                    infoDiv.appendChild(dateSpan);

                    li.appendChild(img);
                    li.appendChild(infoDiv);
                    rssFeedElement.appendChild(li);
                });
            } catch (error) {
                console.error("Error fetching and displaying RSS feeds:", error);
            }
        });
    </script>
</body>
</html>
